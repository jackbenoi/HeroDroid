{"version":3,"sources":["adsController.coffee"],"names":[],"mappings":"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","file":"ads.js","sourcesContent":["###*\n# AdsController\n# __SHORT_DESCRIPTION__\n#\n# @class        AdsController\n# @package      APPMarket.Backend.BackendApp\n# @author       Anthony Pillos <me@anthonypillos.com>\n# @copyright    Copyright (c) 2017 Anthony Pillos. (http://anthonypillos.com,http://iapdesign.com,http://developers.ph)\n# @version      v1\n###\n\nAPPMarket.Backend.BackendApp.controller \"AdsController\",\n['$scope'\n'$rootScope'\n'$timeout'\n'ApiFactory'\n'ListingService'\n'blockUI'\n'SystemFactory'\n'UploaderFactory'\n'SweetAlertService'\n($scope\n$rootScope\n$timeout\n$apiFactory\n$listingService\nblockUI\n$systemFactory\n$uploaderFactory\n$sweetAlertService) ->\n\n    class AdsController\n\n        ###*\n        #\n        # @return\n        ###\n        constructor : () ->\n\n            $scope.resources    = APPMarket.Resources\n            $scope.vars         = APPMarket.Vars\n            $scope.link         =\n                lists  : $scope.resources.index\n                save  : $scope.resources.save\n\n            $scope.blockUITable = $scope.blockui('blockui-table')\n            $scope.blockUINew   = $scope.blockui('blockui-new')\n            $scope.blockui      = $scope.blockui('blockui-effect')\n\n            # object model\n            $scope.details = {}\n            $scope.isEdit  = false\n\n            # listing\n            $scope.pagePresetKey = 'iqcms-ads'\n            $scope = angular.extend $scope, $listingService, {\n                getCollections: (pageNum) -> $scope.getOrderLists(pageNum)\n            }\n            $scope.loadCollections()\n\n            $scope.adsBlockLists = []\n            $scope.adsPlacements = {}\n\n            $scope.adsArray     = $scope.vars.adsArray\n            $scope.adsPlacement = $scope.vars.adsPlacement\n\n\n        $scope.$watch 'adsBlockLists', (newVal, oldVal) ->\n            if newVal != oldVal\n                angular.forEach $scope.adsArray, (ads,key) ->\n\n                    blockLists = _.findWhere $scope.adsBlockLists, {id: ads.advertisement_blocks_id}\n                    $scope.adsPlacements[ads.identifier] = blockLists\n\n        $scope.loadAdsBlock = () ->\n\n            $scope.blockui.start 'Please wait...'\n            routes = $scope.link.lists+'?return=all'\n            $apiFactory.sendRequest {},routes,'GET'\n                .success (response) ->\n                    if response.status is 'error'\n                        console.log 'error'\n                    else\n                        $scope.adsBlockLists = response.data\n\n                    $scope.blockui.stop()\n\n\n\n        $scope.loadCollections = () ->\n            $timeout () ->\n\n                pageNum = _h.get($scope.pagePresetKey ) || 1\n                if $scope.details.search != '' || $scope.details.letter != ''\n                    pageNum = 1\n                $scope.getCollections pageNum\n\n        $scope.getOrderLists = (pageNum) ->\n            pageNum = pageNum || 1\n            $scope.blockUITable.start('Please Wait . . .')\n\n            _h.set $scope.pagePresetKey, pageNum\n\n            perpage = '&per_page=30'\n            routes = $scope.link.lists+'?page='+pageNum+perpage\n\n            $scope.requestData routes, 'GET'\n                .success (response) ->\n\n                    if response.data?\n                        angular.bind $scope, $scope.dataHandler response\n                    else\n                        _h.set $scope.pagePresetKey, 1\n                        $scope.data       = []\n                        $scope.range      = []\n                        $scope.totalPages = 0\n\n                    $timeout () ->\n                        $scope.blockUITable.stop()\n                    ,500\n\n\n       $scope.clearBlock = () ->\n            $scope.details  = {}\n            $scope.isEdit   = false\n\n        $scope.updateData = (blockObj) ->\n            $scope.blockUINew.start('Please Wait . . .')\n\n            $apiFactory.sendRequest $scope.details, $scope.link.lists+'/'+blockObj.id, 'PUT'\n            .then (response) ->\n                if response.data.status is 'error'\n                    $scope.alertMsg {msg: response.data.message}\n                else\n                    window.location.reload()\n\n                $scope.blockUINew.stop()\n\n        $scope.editData = (blockObj) ->\n            $scope.isEdit  = true\n            $scope.details = blockObj\n\n\n        $scope.addData = () ->\n            $scope.blockUINew.start('Please Wait . . .')\n            routes = $scope.link.adsBlockUrl\n\n            $apiFactory.sendRequest $scope.details, $scope.link.lists, 'POST'\n            .then (response) ->\n                if response.data.status is 'error'\n                    $scope.alertMsg {msg: response.data.message}\n                else\n                    window.location.reload()\n\n                $scope.blockUINew.stop()\n            , (response) ->\n                if response.data.status is 'error'\n                    $scope.alertMsg {msg: response.data.message}\n\n                $scope.blockUINew.stop()\n\n        $scope.delRequest   = (data) ->\n\n            $scope.blockUITable.start('Please Wait . . .')\n            $apiFactory.sendRequest {}, $scope.link.lists+'/'+data.id, 'DELETE'\n            .then (response) ->\n                if response.data.status is 'error'\n                    $scope.alertMsg {msg: response.data.message}\n                else\n                    $scope.alertMsg {msg: response.data.message,success: true}\n                    $scope.loadCollections()\n\n                $scope.blockUITable.stop()\n\n        $scope.delModal = (data) ->\n            \n            opts = \n                title               :'Please Confirm'\n                text                : _h.sprintf 'Do you want to delete this block (<strong>%s</strong>)?',data.title\n                html                : true\n                showCancelButton    : true\n                cancelButtonText    : 'Cancel'\n            $sweetAlertService.swal opts, (isConfirm) ->\n                if(isConfirm)\n                    $scope.delRequest data\n\n\n        $scope.alertMsg = (opts) ->\n            options =\n                title : 'System Response'\n                msg   : 'Problem in your request!'\n            opt = angular.merge options,opts\n\n            if opt.success is true\n                return $sweetAlertService.success opt.title,opt.msg\n            return $sweetAlertService.error opt.title,opt.msg\n\n        $scope.blockui = (instanceName) ->\n                return blockUI.instances.get(instanceName)\n\n    new AdsController()\n\n]"]}