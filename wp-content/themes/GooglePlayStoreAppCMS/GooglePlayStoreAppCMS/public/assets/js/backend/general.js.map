{"version":3,"sources":["generalController.coffee"],"names":[],"mappings":"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","file":"general.js","sourcesContent":["###*\n# GeneralController\n# __SHORT_DESCRIPTION__\n#\n# @class        GeneralController\n# @package      APPMarket.Backend.BackendApp\n# @author       Anthony Pillos <me@anthonypillos.com>\n# @copyright    Copyright (c) 2017 Anthony Pillos. (http://anthonypillos.com,http://iapdesign.com,http://developers.ph)\n# @version      v1\n###\n\nAPPMarket.Backend.BackendApp.controller \"GeneralController\",\n['$scope'\n'$timeout'\n'$rootScope'\n'ApiFactory'\n'ListingService'\n'SystemFactory'\n'blockUI'\n'SweetAlertService'\n'UploaderFactory'\n($scope\n$timeout\n$rootScope\n$apiFactory\n$listingService\n$systemFactory\nblockUI\n$sweetAlertService\n$uploaderFactory) ->\n\n    class GeneralController\n\n        ###*\n        #\n        # @return\n        ###\n        constructor : () ->\n\n            $scope.resources \t= APPMarket.Resources\n            $scope.vars         = APPMarket.Vars\n            $scope.link         =\n                lists       : $scope.resources.index\n                validateApi : $scope.resources.validateApi\n                uploadLogo  : $scope.resources.uploadLogo\n\n            $scope.blockUI = $scope.blockui('blockui-effect')\n            $scope.details = []\n            $scope.upload  = {}\n\n            $scope.lists()\n\n\n        uploadSingle = $rootScope.$on 'file:uploading', (evt,fileObj,identifier,isMultiple) ->\n\n            # validation\n            $timeout () ->\n\n                if identifier is 'app-image'\n                    $scope.upload.file = fileObj\n\n        complete = $rootScope.$on 'upload:complete', (evt, data, index)->\n                \n                resp = JSON.parse $uploaderFactory.dataObj[index].xhr.response\n\n                if resp.status is 'error'\n                    $scope.alertMsg {msg: resp.message}\n\n                    if angular.isDefined($scope.blockUI)    \n                        $scope.blockUI.stop()\n\n                    return true\n\n                $scope.alertMsg {msg: resp.message,success:true}\n                window.location.reload()\n                            \n        $scope.uploadImage = ($image_key) ->\n\n            if angular.isUndefined($scope.upload.image_key)\n                $scope.upload.image_key = {}\n\n            $scope.upload.image_key = $image_key\n\n            sendData = $systemFactory.objectToFormData($scope.upload)\n            $uploaderFactory.upload $scope.link.uploadLogo,sendData,[]\n\n\n        $scope.deleteImage = (detail) ->\n            $scope.blockUI.start('Please Wait . . .')\n            $apiFactory.sendRequest detail, $scope.link.uploadLogo,'POST'\n            .then (response) ->\n                if response.data.status is 'error'\n                    $scope.alertMsg {msg: response.data.message}\n                    $scope.blockUI.stop()\n                else\n                    window.location.reload()\n                    $scope.blockUI.stop()\n\n        $scope.lists = () ->\n            $scope.blockUI.start('Please Wait . . .')\n            $apiFactory.sendRequest {}, $scope.link.lists,'GET'\n            .then (response) ->\n                if response.data.status is 'error'\n                    $scope.alertMsg {msg: response.data.message}\n                    $scope.blockUI.stop()\n                else\n                    dataObj        = response.data.data\n                    $scope.details = dataObj\n\n                    $scope.blockUI.stop()\n\n        $scope.update = (details) ->\n\n            obj = {}\n            angular.forEach details, (input) ->\n                _.each input.lists, (item) ->\n                    obj[item.key] = item.value\n\n            $scope.blockUI.start('Please Wait . . .')\n            $apiFactory.sendRequest obj, $scope.link.lists+'/saving','PUT'\n            .then (response) ->\n                if response.data.status is 'error'\n                    $scope.alertMsg {msg: response.data.message}\n                    $scope.blockUI.stop()\n                else\n                    dataObj        = response.data.data\n                    $scope.alertMsg {msg: response.data.message,success:true}\n\n                $scope.blockUI.stop()\n\n        $scope.validatePurchaseCode = () ->\n            apiLists = $scope.details.apk_download_via_api.lists\n\n            puchaseCode   = ''\n            buyerUsername = ''\n\n            _.each apiLists, (data) ->\n\n                if data.key is 'purchase_code'\n                    puchaseCode = data['value']\n\n                if data.key is 'buyer_username'\n                    buyerUsername = data['value']\n\n\n            if puchaseCode and buyerUsername\n\n                obj = \n                    purchase_code: puchaseCode\n                    buyer_username: buyerUsername\n\n                $scope.blockUI.start('Please Wait . . .')\n                $apiFactory.sendRequest obj, $scope.link.validateApi,'POST'\n                .then (response) ->\n                    if response.data.status is 'error'\n                        $scope.alertMsg {msg: response.data.message}\n                        $scope.blockUI.stop()\n                    else\n                        dataObj = response.data.data\n\n                        _.each apiLists, (data) ->\n                            if data.key is 'download_api_url'\n                                data['value'] = dataObj.api\n                                return\n\n                        $scope.details.apk_download_via_api.lists = apiLists\n\n                        $scope.alertMsg {msg: response.data.message,success:true}\n\n                    $scope.blockUI.stop()\n            else\n                $scope.alertMsg {msg: \"No purchase code and buyer username found\"}\n\n            \n        $scope.alertMsg = (opts) ->\n            options =\n                title : 'System Response'\n                msg   : 'Problem in your request!'\n            opt = angular.merge options,opts\n\n            if opt.success is true\n                return $sweetAlertService.success opt.title,opt.msg\n\n            return $sweetAlertService.error opt.title,opt.msg\n\n        $scope.blockui = (instanceName) ->\n                return blockUI.instances.get(instanceName)\n    new GeneralController()\n\n]"]}